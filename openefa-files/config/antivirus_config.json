{
  "_comment": "OpenEFA ClamAV Antivirus Configuration",
  "_version": "1.0.0",
  "_last_updated": "2025-10-14",

  "enabled": true,
  "clamd_socket": "/var/run/clamav/clamd.ctl",
  "timeout": 120,
  "max_file_size_mb": 50,
  "scan_archives": true,
  "scan_pdf": true,

  "actions": {
    "virus_detected": "quarantine",
    "scan_failed": "pass_through",
    "_comment_actions": "Options: quarantine, reject, tag, pass_through"
  },

  "scoring": {
    "virus_detected": 20.0,
    "scan_error": 0.0,
    "_comment_scoring": "Spam score points to add"
  },

  "per_domain_settings": {
    "enabled": true,
    "default_enabled": true,
    "_comment": "Future: Per-domain enable/disable"
  },

  "exclusions": {
    "skip_trusted_senders": false,
    "skip_authenticated": false,
    "max_scan_size_mb": 50,
    "_comment": "Optional exclusions to improve performance"
  },

  "logging": {
    "log_all_scans": false,
    "log_detections_only": true,
    "database_tracking": true,
    "_comment": "Database tracking requires virus_detections table"
  },

  "performance": {
    "max_scan_time_seconds": 30,
    "parallel_scanning": false,
    "_comment": "Parallel scanning not yet implemented"
  }
}
